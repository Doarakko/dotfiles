---
name: docs-update
description: コード変更に合わせてドキュメントを更新するときに使用
allowed-tools: Read, Write, Edit, Grep, Glob, Bash
---

# ドキュメント更新基準

現在のブランチのコード変更に基づいて、プロジェクトのドキュメントを同期・更新する。

## 更新手順

### 1. 現在のブランチの変更を把握
- `git diff` と `git diff --cached` で未コミットの変更を取得
- メインブランチを特定（`git symbolic-ref refs/remotes/origin/HEAD` で確認、main または master）
- `git log <メインブランチ>..HEAD --oneline` でコミット済みの変更を確認し、`git diff <メインブランチ>...HEAD` で差分を取得
- 両方を合わせて変更内容を分析し、ドキュメント更新が必要な箇所を特定する

### 2. ドキュメントへの影響を判定
変更内容に応じて、更新が必要なドキュメントを判定する:

- **依存関係の変更**（package.json, pyproject.toml, go.mod等）→ セットアップ手順、インストール手順
- **スクリプト・コマンドの変更**（package.json scripts, Makefile等）→ 利用可能なコマンド一覧、開発ワークフロー
- **環境変数の変更**（.env.example等）→ 環境変数ドキュメント、セットアップ手順
- **APIの変更**（ルーティング、エンドポイント定義）→ API仕様ドキュメント
- **設定ファイルの変更**（docker-compose.yml等）→ インフラ・デプロイ手順
- **機能の追加・変更・削除** → README.md、ユーザー向けドキュメント

### 3. ドキュメントの更新
- 影響のあるドキュメントファイルを `Glob` で探索し `Read` で読み込む
- 変更内容に合わせてドキュメントを更新する
- 新しく追加された機能・設定にドキュメントがない場合は追記する
- 削除された機能・設定に関する記述があれば削除する

### 4. 陳腐化したドキュメントの検出
- `Glob` で `docs/` 配下や `*.md` ファイルを探索
- `Bash` で `git log` を使い、90日以上更新されていないドキュメントを検出
- 該当ファイルをリストアップし、更新または削除を提案

### 5. 差分サマリーの表示
- 更新したファイルと変更内容の一覧を表示
